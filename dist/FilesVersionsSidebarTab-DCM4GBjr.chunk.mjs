import{N as te,u as se,d as W,s as Z}from"./index-JpgrUA2Z-C7mmv1ig.chunk.mjs";import{E as m,o as r,H as k,F as y,f as C,z as O,j as B,q as z,l as oe,s as b,t as l,B as T,c as S,w as h,y as d,e as E,b as H,a2 as J,p as ne,ak as Q,g as re,x as I,Q as ie,al as ae,ad as le,M as ce,N as ue,a6 as M}from"./string_decoder-BycPOoxV.chunk.mjs";import{N as de}from"./mdi-C5IU8XSu.chunk.mjs";import{h as ve,P as Y}from"./index-wSAHvg0K.chunk.mjs";import{m as G,N as me}from"./index-CIFgSuE2.chunk.mjs";import{_ as A,j as pe,e as X,c as fe}from"./_plugin-vue_export-helper-DM8WuWZR.chunk.mjs";import{N as D,a as he}from"./NcActionRouter-oT-YU_jf-axw0lkuI.chunk.mjs";import{N as ge}from"./NcAvatar-DmUGApWA-CtqXBt90.chunk.mjs";import{_ as be}from"./index-Bamwag0s.chunk.mjs";import{D as ye,_ as we}from"./TrashCanOutline-CC4vElfR.chunk.mjs";import{D as _e,s as Ce}from"./TrayArrowDown-C-BqUyi0.chunk.mjs";import{c as ke}from"./index-D6zY57LV.chunk.mjs";import{g as Ve}from"./dav-B_fZ4j3M.chunk.mjs";import"./NcNoteCard-CVhtNL04-BuDL6zff.chunk.mjs";import"./index-DpibbgL8.chunk.mjs";import"./colors-Go3zmZRD-CR3eBara.chunk.mjs";import"./NcUserStatusIcon-CGEf7fej-DG3KCpud.chunk.mjs";import"./NcInputField-Bwsh2aHY-DMKjn_ao.chunk.mjs";const He={name:"BackupRestoreIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Se=["aria-hidden","aria-label"],Le=["fill","width","height"],ze={d:"M12,3A9,9 0 0,0 3,12H0L4,16L8,12H5A7,7 0 0,1 12,5A7,7 0 0,1 19,12A7,7 0 0,1 12,19C10.5,19 9.09,18.5 7.94,17.7L6.5,19.14C8.04,20.3 9.94,21 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M14,12A2,2 0 0,0 12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12Z"},$e={key:0};function xe(i,t,e,c,p,n){return r(),m("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon backup-restore-icon",role:"img",onClick:t[0]||(t[0]=u=>i.$emit("click",u))}),[(r(),m("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[k("path",ze,[e.title?(r(),m("title",$e,C(e.title),1)):y("",!0)])],8,Le))],16,Se)}const Ae=A(He,[["render",xe]]),Ee={name:"FileCompareIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ne=["aria-hidden","aria-label"],Ie=["fill","width","height"],Me={d:"M10,18H6V16H10V18M10,14H6V12H10V14M10,1V2H6C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H10V23H12V1H10M20,8V20C20,21.11 19.11,22 18,22H14V20H18V11H14V9H18.5L14,4.5V2L20,8M16,14H14V12H16V14M16,18H14V16H16V18Z"},De={key:0};function Te(i,t,e,c,p,n){return r(),m("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon file-compare-icon",role:"img",onClick:t[0]||(t[0]=u=>i.$emit("click",u))}),[(r(),m("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[k("path",Me,[e.title?(r(),m("title",De,C(e.title),1)):y("",!0)])],8,Ie))],16,Ne)}const Oe=A(Ee,[["render",Te]]),Be={name:"ImageOffOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Pe=["aria-hidden","aria-label"],Re=["fill","width","height"],Ue={d:"M22 20.7L3.3 2L2 3.3L3 4.3V19C3 20.1 3.9 21 5 21H19.7L20.7 22L22 20.7M5 19V6.3L12.6 13.9L11.1 15.8L9 13.1L6 17H15.7L17.7 19H5M8.8 5L6.8 3H19C20.1 3 21 3.9 21 5V17.2L19 15.2V5H8.8"},qe={key:0};function Fe(i,t,e,c,p,n){return r(),m("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon image-off-outline-icon",role:"img",onClick:t[0]||(t[0]=u=>i.$emit("click",u))}),[(r(),m("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[k("path",Ue,[e.title?(r(),m("title",qe,C(e.title),1)):y("",!0)])],8,Re))],16,Pe)}const Ke=A(Be,[["render",Fe]]),je={name:"PencilOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},We=["aria-hidden","aria-label"],Ze=["fill","width","height"],Ye={d:"M14.06,9L15,9.94L5.92,19H5V18.08L14.06,9M17.66,3C17.41,3 17.15,3.1 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18.17,3.09 17.92,3 17.66,3M14.06,6.19L3,17.25V21H6.75L17.81,9.94L14.06,6.19Z"},Je={key:0};function Qe(i,t,e,c,p,n){return r(),m("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon pencil-outline-icon",role:"img",onClick:t[0]||(t[0]=u=>i.$emit("click",u))}),[(r(),m("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[k("path",Ye,[e.title?(r(),m("title",Je,C(e.title),1)):y("",!0)])],8,Ze))],16,We)}const Ge=A(je,[["render",Qe]]),Xe={key:0,class:"version__image"},ei=["src"],ii={key:2,class:"version__image"},ti={class:"version__info"},si=["title"],oi={key:1,class:"version__info","data-cy-files-version-author-name":""},ni={key:0},ri=["title"],ai={class:"version__info version__info__subline"},li=B({__name:"VersionEntry",props:{version:{type:Object,required:!0},node:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1},isFirstVersion:{type:Boolean,default:!1},loadPreview:{type:Boolean,default:!1},canView:{type:Boolean,default:!1},canCompare:{type:Boolean,default:!1}},emits:["click","compare","restore","delete","label-update-request"],setup(i,{emit:t}){const e=i,c=t,p=(a,w)=>(a&w)!==0,n=z(!1),u=z(!1),_=z(oe("core","capabilities",{files:{version_labeling:!1,version_deletion:!1}})),f=b(()=>ve(e.version.size)),g=b(()=>{const a=e.version.label??"";return e.isCurrent?a===""?l("files_versions","Current version"):`${a} (${l("files_versions","Current version")})`:e.isFirstVersion&&a===""?l("files_versions","Initial version"):a}),o=b(()=>!e.version.author||!e.version.authorName?"":e.version.author===T()?.uid?l("files_versions","You"):e.version.authorName??e.version.author),L=b(()=>G(e.version.mtime).format("LLLL")),V=b(()=>e.isCurrent?e.node.source:pe()+e.version.url),$=b(()=>_.value.files.version_labeling===!0),R=b(()=>_.value.files.version_deletion===!0),U=b(()=>p(e.node.permissions,Y.DELETE)),N=b(()=>p(e.node.permissions,Y.UPDATE)),q=b(()=>!((e.node.permissions&Y.READ)===0||e.node.attributes["mount-type"]==="shared"&&e.node.attributes["share-attributes"]&&(JSON.parse(e.node.attributes["share-attributes"]).find(a=>a.scope==="permissions"&&a.key==="download")||{})?.value===!1));function F(){c("label-update-request")}function K(){c("restore",e.version)}async function j(){await J(),await J(),c("delete",e.version)}function s(a){e.canView&&a.preventDefault(),c("click",{version:e.version})}function v(){if(!e.canView)throw new Error("Cannot compare version of this file");c("compare",{version:e.version})}return(a,w)=>(r(),S(d(me),{class:"version","force-display-actions":!0,"actions-aria-label":d(l)("files_versions","Actions for version from {versionHumanExplicitDate}",{versionHumanExplicitDate:L.value}),"data-files-versions-version":i.version.fileVersion,href:V.value,onClick:s},{icon:h(()=>[i.loadPreview||n.value?i.version.previewUrl&&!u.value?(r(),m("img",{key:1,src:i.version.previewUrl,alt:"",decoding:"async",fetchpriority:"low",loading:"lazy",class:"version__image",onLoad:w[0]||(w[0]=ee=>n.value=!0),onError:w[1]||(w[1]=ee=>u.value=!0)},null,40,ei)):(r(),m("div",ii,[H(Ke,{size:20})])):(r(),m("div",Xe))]),name:h(()=>[k("div",ti,[g.value?(r(),m("div",{key:0,class:"version__info__label","data-cy-files-version-label":"",title:g.value},C(g.value),9,si)):y("",!0),o.value?(r(),m("div",oi,[g.value?(r(),m("span",ni,"•")):y("",!0),H(d(ge),{class:"avatar",user:i.version.author??void 0,size:20,"disable-menu":"","disable-tooltip":"","hide-status":""},null,8,["user"]),k("div",{class:"version__info__author_name",title:o.value},C(o.value),9,ri)])):y("",!0)])]),subname:h(()=>[k("div",ai,[H(d(be),{class:"version__info__date","relative-time":"short",timestamp:i.version.mtime},null,8,["timestamp"]),w[2]||(w[2]=k("span",null,"•",-1)),k("span",null,C(f.value),1)])]),actions:h(()=>[$.value&&N.value?(r(),S(d(D),{key:0,"data-cy-files-versions-version-action":"label","close-after-click":!0,onClick:F},{icon:h(()=>[H(Ge,{size:22})]),default:h(()=>[E(" "+C(i.version.label===""?d(l)("files_versions","Name this version"):d(l)("files_versions","Edit version name")),1)]),_:1})):y("",!0),!i.isCurrent&&i.canView&&i.canCompare?(r(),S(d(D),{key:1,"data-cy-files-versions-version-action":"compare","close-after-click":!0,onClick:v},{icon:h(()=>[H(Oe,{size:22})]),default:h(()=>[E(" "+C(d(l)("files_versions","Compare to current version")),1)]),_:1})):y("",!0),!i.isCurrent&&N.value?(r(),S(d(D),{key:2,"data-cy-files-versions-version-action":"restore","close-after-click":!0,onClick:K},{icon:h(()=>[H(Ae,{size:22})]),default:h(()=>[E(" "+C(d(l)("files_versions","Restore version")),1)]),_:1})):y("",!0),q.value?(r(),S(d(he),{key:3,"data-cy-files-versions-version-action":"download",href:V.value,"close-after-click":!0,download:V.value},{icon:h(()=>[H(_e,{size:22})]),default:h(()=>[E(" "+C(d(l)("files_versions","Download version")),1)]),_:1},8,["href","download"])):y("",!0),!i.isCurrent&&R.value&&U.value?(r(),S(d(D),{key:4,"data-cy-files-versions-version-action":"delete","close-after-click":!0,onClick:j},{icon:h(()=>[H(ye,{size:22})]),default:h(()=>[E(" "+C(d(l)("files_versions","Delete version")),1)]),_:1})):y("",!0)]),_:1},8,["actions-aria-label","data-files-versions-version","href"]))}}),ci=A(li,[["__scopeId","data-v-5a7e2079"]]),ui={class:"version-label-modal__info"},di=B({__name:"VersionLabelDialog",props:{open:{type:Boolean,default:!1},label:{type:String,default:""}},emits:["update:open","update:label"],setup(i,{emit:t}){const e=i,c=t,p=ne("labelInput"),n=z(""),u=b(()=>{const f=[];return e.label.trim()===""?f.push({label:l("files_versions","Cancel")}):f.push({label:l("files_versions","Remove version name"),type:"reset",variant:"error",callback:()=>{_("")}}),[...f,{label:l("files_versions","Save version name"),icon:Ce,type:"submit",variant:"primary"}]});Q(()=>{n.value=e.label??""}),Q(()=>{e.open&&J(()=>p.value?.focus()),n.value=e.label});function _(f){c("update:label",f)}return(f,g)=>(r(),S(d(te),{buttons:u.value,"content-classes":"version-label-modal","is-form":"",open:i.open,size:"normal",name:d(l)("files_versions","Name this version"),"onUpdate:open":g[1]||(g[1]=o=>f.$emit("update:open",o)),onSubmit:g[2]||(g[2]=o=>_(n.value))},{default:h(()=>[H(d(we),{ref_key:"labelInput",ref:p,modelValue:n.value,"onUpdate:modelValue":g[0]||(g[0]=o=>n.value=o),class:"version-label-modal__input",label:d(l)("files_versions","Version name"),placeholder:d(l)("files_versions","Version name")},null,8,["modelValue","label","placeholder"]),k("p",ui,C(d(l)("files_versions","Named versions are persisted, and excluded from automatic cleanups when your storage quota is full.")),1)]),_:1},8,["buttons","open","name"]))}}),vi=A(di,[["__scopeId","data-v-6a69577b"]]),x=re().setApp("files_version").detectUser().build(),mi=B({name:"VirtualScrolling",props:{sections:{type:Array,required:!0},containerElement:{type:HTMLElement,default:null},useWindow:{type:Boolean,default:!1},headerHeight:{type:Number,default:75},renderDistance:{type:Number,default:.5},bottomBufferRatio:{type:Number,default:2},scrollToKey:{type:String,default:""}},emits:["need-content"],data(){return{scrollPosition:0,containerHeight:0,rowsContainerHeight:0,resizeObserver:null}},computed:{visibleSections(){x.debug("[VirtualScrolling] Computing visible section",{sections:this.sections});const i=this.containerHeight,t=this.scrollPosition,e=t+i;let c=0,p=0;const n=this.sections.map(o=>(p+=this.headerHeight,{...o,rows:o.rows.reduce((L,V)=>{c=p,p+=V.height;let $=0;return p<t?$=(t-p)/i:c>e&&($=(c-e)/i),$>this.renderDistance?L:[...L,{...V,distance:$}]},[])})).filter(o=>o.rows.length>0),u=n.flatMap(({rows:o})=>o).flatMap(({items:o})=>o),_=this._rowIdToKeyMap;u.forEach(o=>o.key=_[o.id]);const f=u.map(({key:o})=>o).filter(o=>o!==void 0),g=Object.values(_).filter(o=>!f.includes(o));return u.filter(({key:o})=>o===void 0).forEach(o=>o.key=g.pop()??Math.random().toString(36).substr(2)),this._rowIdToKeyMap=u.reduce((o,{id:L,key:V})=>({...o,[`${L}`]:V}),{}),n},totalHeight(){return this.sections.map(i=>this.headerHeight+i.height).reduce((i,t)=>i+t,0)+0},paddingTop(){if(this.visibleSections.length===0)return 0;let i=0;for(const t of this.sections){if(t.key!==this.visibleSections[0].rows[0].sectionKey){i+=this.headerHeight+t.height;continue}for(const e of t.rows){if(e.key===this.visibleSections[0].rows[0].key)return i;i+=e.height}i+=this.headerHeight}return i},rowsContainerStyle(){return{height:`${this.totalHeight}px`,paddingTop:`${this.paddingTop}px`}},isNearBottom(){const i=this.containerHeight*this.bottomBufferRatio;return this.scrollPosition+this.containerHeight>=this.totalHeight-i},container(){return x.debug("[VirtualScrolling] Computing container"),this.containerElement!==null?this.containerElement:this.useWindow?window:this.$refs.container}},watch:{isNearBottom(i){x.debug("[VirtualScrolling] isNearBottom changed",{value:i}),i&&this.$emit("need-content")},visibleSections(){this.isNearBottom&&this.$emit("need-content")},scrollToKey(i){let t=0;for(const e of this.sections){if(e.key!==i){t+=this.headerHeight+e.height;continue}break}x.debug("[VirtualScrolling] Scrolling to",{currentRowTopDistanceFromTop:t}),this.container.scrollTo({top:t,behavior:"smooth"})}},beforeCreate(){this._rowIdToKeyMap={}},mounted(){this.resizeObserver=new ResizeObserver(i=>{for(const t of i){const e=t.contentRect;t.target===this.container&&(this.containerHeight=e.height),t.target.classList.contains("vs-rows-container")&&(this.rowsContainerHeight=e.height)}}),this.useWindow?(window.addEventListener("resize",this.updateContainerSize,{passive:!0}),this.containerHeight=window.innerHeight):this.resizeObserver.observe(this.container),this.resizeObserver.observe(this.$refs.rowsContainer),this.container.addEventListener("scroll",this.updateScrollPosition,{passive:!0})},beforeUnmount(){this.useWindow&&window.removeEventListener("resize",this.updateContainerSize),this.resizeObserver?.disconnect(),this.container.removeEventListener("scroll",this.updateScrollPosition)},methods:{updateScrollPosition(){this._onScrollHandle??=requestAnimationFrame(()=>{this._onScrollHandle=null,this.useWindow?this.scrollPosition=this.container.scrollY:this.scrollPosition=this.container.scrollTop})},updateContainerSize(){this.containerHeight=window.innerHeight}}}),pi={key:0,ref:"container",class:"vs-container"};function fi(i,t,e,c,p,n){return!i.useWindow&&i.containerElement===null?(r(),m("div",pi,[k("div",{ref:"rowsContainer",class:"vs-rows-container",style:ie(i.rowsContainerStyle)},[I(i.$slots,"default",{visibleSections:i.visibleSections},void 0,!0),I(i.$slots,"loader",{},void 0,!0)],4)],512)):(r(),m("div",{key:1,ref:"rowsContainer",class:"vs-rows-container",style:ie(i.rowsContainerStyle)},[I(i.$slots,"default",{visibleSections:i.visibleSections},void 0,!0),I(i.$slots,"loader",{},void 0,!0)],4))}const hi=A(mi,[["render",fi],["__scopeId","data-v-b0f92288"]]),gi=`<?xml version="1.0"?>
<d:propfind xmlns:d="DAV:"
	xmlns:oc="http://owncloud.org/ns"
	xmlns:nc="http://nextcloud.org/ns"
	xmlns:ocs="http://open-collaboration-services.org/ns">
	<d:prop>
		<d:getcontentlength />
		<d:getcontenttype />
		<d:getlastmodified />
		<d:getetag />
		<nc:version-label />
		<nc:version-author />
		<nc:has-preview />
	</d:prop>
</d:propfind>`,P=Ve();async function bi(i){const t=`/versions/${T()?.uid}/versions/${i.fileid}`;try{const e=(await P.getDirectoryContents(t,{data:gi,details:!0})).data.filter(({mime:n})=>n!=="").map(n=>wi(n,i)),c=new Set(e.map(n=>String(n.author))),p=await ke.post(X("/displaynames"),{users:[...c]});for(const n of e){const u=p.data.users[n.author??""];u&&(n.authorName=u)}return e}catch(e){throw x.error("Could not fetch version",{exception:e}),e}}async function yi(i){try{x.debug("Restoring version",{url:i.url}),await P.moveFile(`/versions/${T()?.uid}/versions/${i.fileId}/${i.fileVersion}`,`/versions/${T()?.uid}/restore/target`)}catch(t){throw x.error("Could not restore version",{exception:t}),t}}function wi(i,t){const e=G(i.lastmod).unix()*1e3;let c="";return e===t.mtime?.getTime()?c=X("/core/preview?fileId={fileId}&c={fileEtag}&x=250&y=250&forceIcon=0&a=0&forceIcon=1&mimeFallback=1",{fileId:t.fileid,fileEtag:t.attributes.etag}):c=X("/apps/files_versions/preview?file={file}&version={fileVersion}&mimeFallback=1",{file:t.path,fileVersion:i.basename}),{fileId:t.fileid.toString(),label:i.props["version-label"]?String(i.props["version-label"]):"",author:i.props["version-author"]?String(i.props["version-author"]):null,authorName:null,filename:i.filename,basename:G(e).format("LLL"),mime:i.mime,etag:`${i.props.getetag}`,size:i.size,type:i.type,mtime:e,permissions:"R",previewUrl:c,url:ae("/remote.php/dav",i.filename),source:fe("dav")+le(i.filename),fileVersion:i.basename}}async function _i(i,t){return await P.customRequest(i.filename,{method:"PROPPATCH",data:`<?xml version="1.0"?>
					<d:propertyupdate xmlns:d="DAV:"
						xmlns:oc="http://owncloud.org/ns"
						xmlns:nc="http://nextcloud.org/ns"
						xmlns:ocs="http://open-collaboration-services.org/ns">
					<d:set>
						<d:prop>
							<nc:version-label>${t}</nc:version-label>
						</d:prop>
					</d:set>
					</d:propertyupdate>`})}async function Ci(i){await P.deleteFile(i.filename)}const ki={key:0,class:"versions-tab__container"},Vi=["aria-label"],qi=B({__name:"FilesVersionsSidebarTab",props:{node:{},folder:{},view:{}},setup(i,{expose:t}){const e=i;t({setActive:R});const c=se(),p=z(!1),n=z([]),u=z(!1),_=z(!1),f=z(null);Q(async()=>{if(!e.node)return;const s=e.node;try{u.value=!0,n.value=await bi(s)}finally{u.value=!1}});const g=b(()=>[...n.value].sort((s,v)=>e.node?s.mtime===e.node.mtime?.getTime()?-1:v.mtime===e.node.mtime?.getTime()?1:v.mtime-s.mtime:0)),o=b(()=>[{key:"versions",rows:g.value.map(s=>({key:s.mtime.toString(),height:68,sectionKey:"versions",items:[{id:s.mtime.toString(),version:s}]})),height:68*g.value.length}]),L=b(()=>n.value.map(s=>s.mtime).reduce((s,v)=>Math.min(s,v))),V=b(()=>e.node?window.OCA.Viewer?.mimetypes?.includes(e.node?.mime):!1),$=b(()=>!c.value&&window.OCA.Viewer?.mimetypesCompare?.includes(e.node?.mime));function R(s){p.value=s}async function U(s){if(!e.node)return;const v=e.node.clone();v.mtime=new Date(s.mtime),v.attributes.etag=s.etag,v.size=s.size;const a={preventDefault:!1,node:v,version:s};if(M("files_versions:restore:requested",a),!a.preventDefault)try{await yi(s),s.label?W(l("files_versions",`${s.label} restored`)):s.mtime===L.value?W(l("files_versions","Initial version restored")):W(l("files_versions","Version restored")),M("files:node:updated",v),M("files_versions:restore:restored",{node:v,version:s})}catch{Z(l("files_versions","Could not restore version")),M("files_versions:restore:failed",s)}}function N(s){_.value=!0,f.value=s}async function q(s){if(f.value===null)throw new Error("editedVersion should be set at that point");const v=f.value.label;f.value.label=s,_.value=!1;try{await _i(f.value,s),f.value=null}catch(a){f.value.label=v,Z(l("files_versions","Could not set version label")),x.error("Could not set version label",{exception:a})}}async function F(s){const v=n.value.indexOf(s);n.value.splice(v,1);try{await Ci(s)}catch{n.value.push(s),Z(l("files_versions","Could not delete version"))}}function K({version:s}){if(e.node!==null){if(s.mtime===e.node?.mtime?.getTime()){window.OCA.Viewer.open({path:e.node.path});return}window.OCA.Viewer.open({fileInfo:{...s,filename:s.filename,previewUrl:void 0},enableSidebar:!1})}}function j({version:s}){const v=n.value.map(a=>({...a,previewUrl:void 0}));window.OCA.Viewer.compare({path:e.node.path},v.find(a=>a.source===s.source))}return(s,v)=>i.node?(r(),m("div",ki,[H(hi,{sections:o.value,"header-height":0},{default:h(({visibleSections:a})=>[k("ul",{"aria-label":d(l)("files_versions","File versions"),"data-files-versions-versions-list":""},[a.length===1?(r(!0),m(ce,{key:0},ue(a[0].rows,w=>(r(),S(ci,{key:w.items[0].version.mtime,"can-view":V.value,"can-compare":$.value,"load-preview":p.value,version:w.items[0].version,node:i.node,"is-current":w.items[0].version.mtime===i.node.mtime?.getTime(),"is-first-version":w.items[0].version.mtime===L.value,onClick:K,onCompare:j,onRestore:U,onLabelUpdateRequest:ee=>N(w.items[0].version),onDelete:F},null,8,["can-view","can-compare","load-preview","version","node","is-current","is-first-version","onLabelUpdateRequest"]))),128)):y("",!0)],8,Vi)]),loader:h(()=>[u.value?(r(),S(d(de),{key:0,class:"files-list-viewer__loader"})):y("",!0)]),_:1},8,["sections"]),f.value?(r(),S(vi,{key:0,open:_.value,"onUpdate:open":v[0]||(v[0]=a=>_.value=a),label:f.value.label,"onUpdate:label":q},null,8,["open","label"])):y("",!0)])):y("",!0)}});export{qi as default};
//# sourceMappingURL=FilesVersionsSidebarTab-DCM4GBjr.chunk.mjs.map
